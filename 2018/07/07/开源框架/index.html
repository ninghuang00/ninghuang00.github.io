<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>开源框架 | Just Try It</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="开源框架学习">
<meta name="keywords" content="spring,springMVC,kafka">
<meta property="og:type" content="article">
<meta property="og:title" content="开源框架">
<meta property="og:url" content="http://yoursite.com/2018/07/07/开源框架/index.html">
<meta property="og:site_name" content="Just Try It">
<meta property="og:description" content="开源框架学习">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2018/07/07/开源框架/springMVC基本工作流程图.jpeg">
<meta property="og:image" content="http://yoursite.com/2018/07/07/开源框架/SpringMVC中HTTP请求处理流程时序图.jpeg">
<meta property="og:updated_time" content="2018-07-16T15:40:30.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="开源框架">
<meta name="twitter:description" content="开源框架学习">
<meta name="twitter:image" content="http://yoursite.com/2018/07/07/开源框架/springMVC基本工作流程图.jpeg">
  
    <link rel="alternate" href="/atom.xml" title="Just Try It" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Just Try It</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">categories</a>
        
          <a class="main-nav-link" href="/tags">tags</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-开源框架" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/07/07/开源框架/" class="article-date">
  <time datetime="2018-07-07T12:48:49.000Z" itemprop="datePublished">2018-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/框架/">框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      开源框架
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
<div id="toc">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#kafka"><span class="toc-text">kafka</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#基本原理介绍"><span class="toc-text">基本原理介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kafka启动参数"><span class="toc-text">kafka启动参数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring"><span class="toc-text">Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#spring框架的基本原理"><span class="toc-text">spring框架的基本原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#依赖注入"><span class="toc-text">依赖注入()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#控制反转-IOC"><span class="toc-text">控制反转(IOC)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#切面编程-AOP"><span class="toc-text">切面编程(AOP)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通知-Advice"><span class="toc-text">通知(Advice)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#切点-PointCut"><span class="toc-text">切点(PointCut)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用场景"><span class="toc-text">使用场景:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代理"><span class="toc-text">代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务管理"><span class="toc-text">事务管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bean的实例化过程"><span class="toc-text">Bean的实例化过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring和springMVC"><span class="toc-text">spring和springMVC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#传统springMVC的不足"><span class="toc-text">传统springMVC的不足</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注解的使用"><span class="toc-text">注解的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ResponseBody"><span class="toc-text">@ResponseBody</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#返回json数据中文乱码的问题"><span class="toc-text">返回json数据中文乱码的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringMVC-HTTP请求响应的过程"><span class="toc-text">SpringMVC HTTP请求响应的过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring事务"><span class="toc-text">spring事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#传播行为"><span class="toc-text">传播行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#隔离级别"><span class="toc-text">隔离级别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#分布式框架"><span class="toc-text">分布式框架</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis"><span class="toc-text">Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#持久化原理"><span class="toc-text">持久化原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kafka-1"><span class="toc-text">kafka</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#消息队列"><span class="toc-text">消息队列</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MyBatis"><span class="toc-text">MyBatis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据关联"><span class="toc-text">数据关联</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#动态映射"><span class="toc-text">动态映射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务关联"><span class="toc-text">事务关联</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#log4j"><span class="toc-text">log4j</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-xml中的配置"><span class="toc-text">web.xml中的配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码中的使用"><span class="toc-text">代码中的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#log4j-properties"><span class="toc-text">log4j.properties</span></a></li></ol></li></ol>
</div>

        <p> 开源框架学习<br> <a id="more"></a></p>
<h1 id="kafka"><a href="#kafka" class="headerlink" title="kafka"></a>kafka</h1><h2 id="基本原理介绍"><a href="#基本原理介绍" class="headerlink" title="基本原理介绍"></a>基本原理介绍</h2><p>参考地址:<a href="https://blog.csdn.net/csolo/article/details/52389646" target="_blank" rel="noopener">https://blog.csdn.net/csolo/article/details/52389646</a></p>
<h2 id="kafka启动参数"><a href="#kafka启动参数" class="headerlink" title="kafka启动参数"></a>kafka启动参数</h2><ol>
<li>调整JVM堆大小kafka-server-start.sh<br><code>export KAFKA_HEAP_OPTS=&quot;-Xmx256M -Xms128M&quot;</code></li>
</ol>
<h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><h2 id="spring框架的基本原理"><a href="#spring框架的基本原理" class="headerlink" title="spring框架的基本原理"></a>spring框架的基本原理</h2><blockquote>
<p>基本原理其实就是通过反射(反射的原理)解析类及其类的各种信息，包括构造器、方法及其参数，属性。然后将其封装成bean定义信息类、constructor信息类、method信息类、property信息类，最终放在一个map里，也就是所谓的container，池等等，其实就是个map。。汗。。。。当你写好配置文件，启动项目后，框架会先按照你的配置文件找到那个要scan的包(一般是哪些包?)，然后解析包里面的所有类，找到所有含有@bean，@service等注解的类，利用反射解析它们，包括解析构造器，方法，属性等等，然后封装成各种信息类放到一个map里。每当你需要一个bean的时候，框架就会从container找是不是有这个类的定义啊？如果找到则通过构造器new出来（这就是控制反转，不用你new,框架帮你new），再在这个类找是不是有要注入的属性或者方法，比如标有@autowired的属性，如果有则还是到container找对应的解析类，new出对象，并通过之前解析出来的信息类找到setter方法，然后用该方法注入对象（这就是依赖注入）。如果其中有一个类container里没找到，则抛出异常，比如常见的spring无法找到该类定义，无法wire的异常。还有就是嵌套bean则用了一下递归，container会放到servletcontext里面，每次reQuest从servletcontext找这个container即可，不用多次解析类定义。如果bean的scope是singleton，则会重用这个bean不再重新创建，将这个bean放到一个map里，每次用都先从这个map里面找。如果scope是session，则该bean会放到session里面。仅此而已，没必要花更多精力。</p>
</blockquote>
<h2 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入()"></a>依赖注入()</h2><h2 id="控制反转-IOC"><a href="#控制反转-IOC" class="headerlink" title="控制反转(IOC)"></a>控制反转(IOC)</h2><h2 id="切面编程-AOP"><a href="#切面编程-AOP" class="headerlink" title="切面编程(AOP)"></a>切面编程(AOP)</h2><p>参考网址:    <a href="https://www.liaoxuefeng.com/article/0013738774263173c42eae58864423698dd40556af23bb5000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/article/0013738774263173c42eae58864423698dd40556af23bb5000</a></p>
<h3 id="通知-Advice"><a href="#通知-Advice" class="headerlink" title="通知(Advice)"></a>通知(Advice)</h3><p>定义切点何时工作,以工作内容</p>
<pre><code>1. 前置通知(Before):一般是方法调用前打出传入参数
2. 后置通知(After):是返回和异常通知的并集
3. 返回通知(After-running):方法正常返回
4. 异常通知(After-throwing):方法抛出异常
5. 环绕通知(Around):可以同时定义前置和后置
</code></pre><h3 id="切点-PointCut"><a href="#切点-PointCut" class="headerlink" title="切点(PointCut)"></a>切点(PointCut)</h3><p>定义在何处工作,也就是对哪个方法应用通知</p>
<h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景:"></a>使用场景:</h3><ol>
<li>比较常见的就是日志记录,如果不使用aop的话,例子中<strong>实现日志功能的代码就是切面,而需要添加日志的类或者方法就是切点.</strong><ol>
<li>就会在业务组件的核心功能之外附带了其他功能代码,会让业务代码变得混乱,业务组件应该只关心核心功能的实现</li>
<li>比如日志功能如果在多个组件中被使用,那么日志功能的业务逻辑发生改变时,维护修改就很麻烦</li>
</ol>
</li>
<li>日志应用:可以在日志中输出监控对象的方法调用的参数输入,返回结果等<br>比如要监控的对象是要监控<code>LoginServiceImpl.login(String name,String password)</code>,只需要准备一个<code>LogServiceImpl</code>,<code>LogServiceImpl</code>中实现无参日志方法,有参日志方法,还有有参有返回值的日志方法,然后通过<code>applicationContext.xml</code>中的<code>&lt;aop:config&gt;</code>将其中一个日志方法织入<code>LoginServiceImpl</code>中配置,然后在客户端调用login方法的时候日志中就会有相应的输出内容<br>参考地址:<a href="http://www.cnblogs.com/yulinfeng/p/7719128.html" target="_blank" rel="noopener">http://www.cnblogs.com/yulinfeng/p/7719128.html</a></li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id="logService" class="cn.com.spring.service.impl.LogServiceImpl"&gt;&lt;/bean&gt; </span><br><span class="line">&lt;bean id="loginService" class="cn.com.spring.service.impl.LoginServiceImpl"&gt;&lt;/bean&gt; </span><br><span class="line">&lt;aop:config&gt; </span><br><span class="line">    &lt;!-- 切入点 --&gt; </span><br><span class="line">    &lt;aop:pointcut </span><br><span class="line">        expression=<span class="string">"execution(* cn.com.spring.service.impl.LoginServiceImpl.*(..))"</span> </span><br><span class="line">        id=<span class="string">"myPointcut"</span> /&gt; </span><br><span class="line">    &lt;!-- 切面： 将哪个对象中的哪个方法，织入到哪个切入点 --&gt; </span><br><span class="line">    &lt;aop:aspect id=<span class="string">"dd"</span> ref=<span class="string">"logService"</span>&gt; </span><br><span class="line">        &lt;!-- 前置通知 </span><br><span class="line">        &lt;aop:before method=<span class="string">"log"</span> pointcut-ref=<span class="string">"myPointcut"</span> /&gt; </span><br><span class="line">        &lt;aop:after method=<span class="string">"logArg"</span> pointcut-ref=<span class="string">"myPointcut"</span>&gt; </span><br><span class="line">		--&gt; </span><br><span class="line">        &lt;aop:after-returning method=<span class="string">"logArgAndReturn"</span> returning=<span class="string">"returnObj"</span> pointcut-ref=<span class="string">"myPointcut"</span>/&gt; </span><br><span class="line">    &lt;/aop:aspect&gt; </span><br><span class="line">&lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>
<h2 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h2><h2 id="事务管理"><a href="#事务管理" class="headerlink" title="事务管理"></a>事务管理</h2><h2 id="Bean的实例化过程"><a href="#Bean的实例化过程" class="headerlink" title="Bean的实例化过程"></a>Bean的实例化过程</h2><h2 id="spring和springMVC"><a href="#spring和springMVC" class="headerlink" title="spring和springMVC"></a>spring和springMVC</h2><ol>
<li>spring是父容器,springMVC是子容器,spring容器中有Service层的bean,springMVC容器中有Controller层的bean,子容器中找不到的bean可以去父容器中找,但是父容器不能在子容器中查找bean,这就是为什么由SpringMVC容器创建的Controller可以自动注入Spring容器创建的Service的bean了</li>
</ol>
<h2 id="传统springMVC的不足"><a href="#传统springMVC的不足" class="headerlink" title="传统springMVC的不足"></a>传统springMVC的不足</h2><ol>
<li>传统MVC模式的不足<ol>
<li>每次请求都必须经过”控制器-模型-视图”才能最终在浏览器上呈现,过程略显复杂</li>
<li>视图依赖于模型,没有模型,浏览器就无法展示页面,客户体验不好</li>
<li>视图的渲染是在服务器端进行的,最后返回给浏览器的是带有模型的视图,渲染性能不能得到很好的优化</li>
</ol>
</li>
<li>前后端分离的方式<br>就是浏览器发送AJAX请求,然后收到JSON数据返回,然后浏览器来渲染页面</li>
</ol>
<p>*</p>
<h2 id="注解的使用"><a href="#注解的使用" class="headerlink" title="注解的使用"></a>注解的使用</h2><h3 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody"></a>@ResponseBody</h3><p> <code>@ResponseBody</code>注解使用的返回值处理器是<code>RequestResponseBodyMethodProcessor</code>，调用 <code>HttpMessagConverter</code> 消息转换机制。</p>
<p>##Json问题</p>
<h3 id="返回json数据中文乱码的问题"><a href="#返回json数据中文乱码的问题" class="headerlink" title="返回json数据中文乱码的问题"></a>返回json数据中文乱码的问题</h3><ol>
<li><p>方法1:在springMVC.xml中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 处理请求返回json字符串的中文乱码问题 --&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:message-converters</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"supportedMediaTypes"</span>&gt;</span>  </span><br><span class="line">                    <span class="tag">&lt;<span class="name">list</span>&gt;</span>  </span><br><span class="line">                        <span class="tag">&lt;<span class="name">value</span>&gt;</span>application/json;charset=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line">                    <span class="tag">&lt;/<span class="name">list</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>方法二:在url映射注解中添加一段<br> <code>@RequestMapping(value=&quot;/getUsersByPage&quot;,produces = &quot;application/json; charset=utf-8&quot;)</code></p>
</li>
</ol>
<h2 id="SpringMVC-HTTP请求响应的过程"><a href="#SpringMVC-HTTP请求响应的过程" class="headerlink" title="SpringMVC HTTP请求响应的过程"></a>SpringMVC HTTP请求响应的过程</h2><img src="/2018/07/07/开源框架/springMVC基本工作流程图.jpeg" title="springMVC基本工作流程图">
<img src="/2018/07/07/开源框架/SpringMVC中HTTP请求处理流程时序图.jpeg" title="SpringMVC中HTTP请求处理流程时序图">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.用户发起请求到前端控制器。</span><br><span class="line">2.前端控制器通过处理器映射器查找handler。</span><br><span class="line">3.处理器映射器返回执行链。</span><br><span class="line">	a)handler对象</span><br><span class="line">	b)拦截器（集合）</span><br><span class="line">4.前端控制器通处理器适配器包装，执行handler对象。思考：为什么要通过适配器来执行？</span><br><span class="line">5.通过模型handler处理业务逻辑。</span><br><span class="line">6.处理业务完成后，返回ModeAndView对象，其中有视图名称，模型数据。</span><br><span class="line">7.将视图名称和模型数据返回到前端控制器。</span><br><span class="line">8.前端控制器通过视图解释器查找视图对象。</span><br><span class="line">9.视图解释器返回真正的视图。</span><br><span class="line">10.前端控制器通过返回的视图和数据进行渲染。</span><br><span class="line">11.返回渲染完成的视图。</span><br><span class="line">12.将最终的视图返回给用户，产生响应。</span><br></pre></td></tr></table></figure>
<h2 id="spring事务"><a href="#spring事务" class="headerlink" title="spring事务"></a>spring事务</h2><h3 id="传播行为"><a href="#传播行为" class="headerlink" title="传播行为"></a>传播行为</h3><h3 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h3><h1 id="分布式框架"><a href="#分布式框架" class="headerlink" title="分布式框架"></a>分布式框架</h1><h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><h3 id="持久化原理"><a href="#持久化原理" class="headerlink" title="持久化原理"></a>持久化原理</h3><h2 id="kafka-1"><a href="#kafka-1" class="headerlink" title="kafka"></a>kafka</h2><h3 id="消息队列"><a href="#消息队列" class="headerlink" title="消息队列"></a>消息队列</h3><h1 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h1><h2 id="数据关联"><a href="#数据关联" class="headerlink" title="数据关联"></a>数据关联</h2><h2 id="动态映射"><a href="#动态映射" class="headerlink" title="动态映射"></a>动态映射</h2><h2 id="事务关联"><a href="#事务关联" class="headerlink" title="事务关联"></a>事务关联</h2><h1 id="log4j"><a href="#log4j" class="headerlink" title="log4j"></a>log4j</h1><h2 id="web-xml中的配置"><a href="#web-xml中的配置" class="headerlink" title="web.xml中的配置"></a>web.xml中的配置</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置log4j--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>log4jConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/WEB-INF/log4j.properties<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="代码中的使用"><a href="#代码中的使用" class="headerlink" title="代码中的使用"></a>代码中的使用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String LOG_NAME = <span class="string">"hn_log"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String LOG_FORMATTER = <span class="string">"%s : %s.%s - %s"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String LOG_TAG = <span class="string">"hnexia"</span>;</span><br><span class="line">Logger logger = Logger.getLogger(LOG_NAME);</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">String result = ret.toString();</span><br><span class="line">String location = <span class="string">"in logAspect ======================================================================================================="</span>;</span><br><span class="line">logger.info(String.format(LOG_FORMATTER, location + LOG_TAG, className, methodName, result));</span><br></pre></td></tr></table></figure>
<h2 id="log4j-properties"><a href="#log4j-properties" class="headerlink" title="log4j.properties"></a>log4j.properties</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">### set log levels ###</span><br><span class="line">log4j.rootLogger = debug,stdout,D,I,E</span><br><span class="line"></span><br><span class="line"># 控制台输出的配置，所有日志输出，都会显示在控制台</span><br><span class="line">log4j.appender.stdout = org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.Target = System.out</span><br><span class="line">log4j.appender.stdout.layout = org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern = [%-<span class="number">5</span>p] %d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; method:%l%n%m%n</span><br><span class="line"></span><br><span class="line"># DEBUG级别及以上级别的日志，会写到F://logs/log.log文件中，文件不存在的时候会自动创建</span><br><span class="line">#log4j.appender.D = org.apache.log4j.DailyRollingFileAppender</span><br><span class="line">#log4j.appender.D.File = /usr/local/tomcat/webapps/art-education-o2o/logs/debug.log</span><br><span class="line">#log4j.appender.D.Append = true</span><br><span class="line">#log4j.appender.D.Threshold = DEBUG</span><br><span class="line">#log4j.appender.D.layout = org.apache.log4j.PatternLayout</span><br><span class="line">#log4j.appender.D.layout.ConversionPattern = %-d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br><span class="line"></span><br><span class="line"># INFO，会写到F://logs/log.log文件中，文件不存在的时候会自动创建</span><br><span class="line">log4j.appender.I = org.apache.log4j.DailyRollingFileAppender</span><br><span class="line">log4j.appender.I.File = /usr/local/tomcat/webapps/art-education-o2o/logs/info.log</span><br><span class="line">log4j.appender.I.Append = <span class="keyword">true</span></span><br><span class="line">log4j.appender.I.Threshold = INFO</span><br><span class="line">log4j.appender.I.layout = org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.I.layout.ConversionPattern = %-d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br><span class="line"></span><br><span class="line"># ERROR级别及以上级别的日志，会写到F://logs/error.log文件中，文件不存在的时候会自动创建</span><br><span class="line">log4j.appender.E = org.apache.log4j.DailyRollingFileAppender</span><br><span class="line">log4j.appender.E.File =/usr/local/tomcat/webapps/art-education-o2o/logs/error.log</span><br><span class="line">log4j.appender.E.Append = <span class="keyword">true</span></span><br><span class="line">log4j.appender.E.Threshold = ERROR</span><br><span class="line">log4j.appender.E.layout = org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.E.layout.ConversionPattern = %-d&#123;yyyy-MM-dd HH:mm:ss&#125; [%p] %m%n</span><br><span class="line"></span><br><span class="line"># 指定com.neusoft包下的所有类的等级为DEBUG。可以把com.neusoft改为自己项目所用的包名。</span><br><span class="line">log4j.logger.com.neusoft =DEBUG</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/07/07/开源框架/" data-id="cjktx3sfx0028umt950bqs9fn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/springMVC/">springMVC</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/07/07/数据库/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          数据库
        
      </div>
    </a>
  
  
    <a href="/2018/07/07/项目实践积累/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">项目实践积累</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/大纲/">大纲</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/教程/">教程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/框架/">框架</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活方式/">生活方式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/笔记/">笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/">网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArrayList/">ArrayList</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSRF/">CSRF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashMap/">HashMap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashSet/">HashSet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashTable/">HashTable</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IP地址/">IP地址</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK8/">JDK8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java基础/">Java基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LinkedList/">LinkedList</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MAC地址/">MAC地址</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NIO/">NIO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringMVC/">SpringMVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vector/">Vector</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/db2/">db2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/">https</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ibase4j/">ibase4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaweb/">javaweb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk原生线程池/">jdk原生线程池</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda表达式/">lambda表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mpv/">mpv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socket/">socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springMVC/">springMVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stream/">stream</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tcp/">tcp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/udp/">udp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/事务/">事务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代理模式/">代理模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/函数式编程/">函数式编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式锁/">分布式锁</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/单例模式/">单例模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/反向代理/">反向代理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/实践/">实践</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/平衡树/">平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源框架/">开源框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/快捷键/">快捷键</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/思维题/">思维题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/效率/">效率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/教程/">教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库事务/">数据库事务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/枚举/">枚举</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正向代理/">正向代理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/流量控制/">流量控制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/目录/">目录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/知识框架/">知识框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/磁盘存储/">磁盘存储</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/类加载机制/">类加载机制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/索引/">索引</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程/">线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程安全/">线程安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程池/">线程池</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网易/">网易</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/虚拟机/">虚拟机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/进程/">进程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/集合/">集合</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ArrayList/" style="font-size: 10px;">ArrayList</a> <a href="/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/tags/HashMap/" style="font-size: 10px;">HashMap</a> <a href="/tags/HashSet/" style="font-size: 10px;">HashSet</a> <a href="/tags/HashTable/" style="font-size: 10px;">HashTable</a> <a href="/tags/IP地址/" style="font-size: 10px;">IP地址</a> <a href="/tags/JDK8/" style="font-size: 10px;">JDK8</a> <a href="/tags/JVM/" style="font-size: 13.33px;">JVM</a> <a href="/tags/Java/" style="font-size: 13.33px;">Java</a> <a href="/tags/Java基础/" style="font-size: 10px;">Java基础</a> <a href="/tags/LinkedList/" style="font-size: 10px;">LinkedList</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MAC地址/" style="font-size: 10px;">MAC地址</a> <a href="/tags/NIO/" style="font-size: 10px;">NIO</a> <a href="/tags/SpringMVC/" style="font-size: 10px;">SpringMVC</a> <a href="/tags/Vector/" style="font-size: 10px;">Vector</a> <a href="/tags/centos/" style="font-size: 10px;">centos</a> <a href="/tags/db2/" style="font-size: 10px;">db2</a> <a href="/tags/git/" style="font-size: 13.33px;">git</a> <a href="/tags/http/" style="font-size: 13.33px;">http</a> <a href="/tags/https/" style="font-size: 10px;">https</a> <a href="/tags/ibase4j/" style="font-size: 10px;">ibase4j</a> <a href="/tags/javaweb/" style="font-size: 10px;">javaweb</a> <a href="/tags/jdk原生线程池/" style="font-size: 10px;">jdk原生线程池</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/lambda表达式/" style="font-size: 10px;">lambda表达式</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/mpv/" style="font-size: 10px;">mpv</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/socket/" style="font-size: 10px;">socket</a> <a href="/tags/spring/" style="font-size: 13.33px;">spring</a> <a href="/tags/springMVC/" style="font-size: 10px;">springMVC</a> <a href="/tags/stream/" style="font-size: 10px;">stream</a> <a href="/tags/tcp/" style="font-size: 10px;">tcp</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/udp/" style="font-size: 10px;">udp</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/事务/" style="font-size: 10px;">事务</a> <a href="/tags/代理模式/" style="font-size: 10px;">代理模式</a> <a href="/tags/函数式编程/" style="font-size: 10px;">函数式编程</a> <a href="/tags/分布式锁/" style="font-size: 10px;">分布式锁</a> <a href="/tags/单例模式/" style="font-size: 10px;">单例模式</a> <a href="/tags/反向代理/" style="font-size: 10px;">反向代理</a> <a href="/tags/实践/" style="font-size: 10px;">实践</a> <a href="/tags/平衡树/" style="font-size: 10px;">平衡树</a> <a href="/tags/开源框架/" style="font-size: 10px;">开源框架</a> <a href="/tags/快捷键/" style="font-size: 13.33px;">快捷键</a> <a href="/tags/思维题/" style="font-size: 10px;">思维题</a> <a href="/tags/效率/" style="font-size: 10px;">效率</a> <a href="/tags/教程/" style="font-size: 10px;">教程</a> <a href="/tags/数据库/" style="font-size: 20px;">数据库</a> <a href="/tags/数据库事务/" style="font-size: 10px;">数据库事务</a> <a href="/tags/枚举/" style="font-size: 10px;">枚举</a> <a href="/tags/正向代理/" style="font-size: 10px;">正向代理</a> <a href="/tags/流量控制/" style="font-size: 10px;">流量控制</a> <a href="/tags/目录/" style="font-size: 10px;">目录</a> <a href="/tags/知识框架/" style="font-size: 10px;">知识框架</a> <a href="/tags/磁盘存储/" style="font-size: 10px;">磁盘存储</a> <a href="/tags/算法/" style="font-size: 16.67px;">算法</a> <a href="/tags/类加载机制/" style="font-size: 10px;">类加载机制</a> <a href="/tags/索引/" style="font-size: 10px;">索引</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a> <a href="/tags/线程安全/" style="font-size: 10px;">线程安全</a> <a href="/tags/线程池/" style="font-size: 10px;">线程池</a> <a href="/tags/网易/" style="font-size: 10px;">网易</a> <a href="/tags/虚拟机/" style="font-size: 10px;">虚拟机</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/进程/" style="font-size: 10px;">进程</a> <a href="/tags/集合/" style="font-size: 10px;">集合</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2118/07/">July 2118</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2118/07/07/Java开发知识框架/">Java开发知识框架</a>
          </li>
        
          <li>
            <a href="/2018/08/14/分布式/">分布式</a>
          </li>
        
          <li>
            <a href="/2018/08/12/数据库事务/">数据库事务</a>
          </li>
        
          <li>
            <a href="/2018/08/11/mpv快捷键/">mpv快捷键</a>
          </li>
        
          <li>
            <a href="/2018/08/07/SpringMVC/">SpringMVC</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 ninghuang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">categories</a>
  
    <a href="/tags" class="mobile-nav-link">tags</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>